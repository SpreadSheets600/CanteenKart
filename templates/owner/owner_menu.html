{% extends 'base.html' %}
{% block title %}Owner Menu - CanteenKart{% endblock %}
{% block content %}

<h1 class="text-3xl font-bold mb-8 text-gray-800">Owner Menu Management</h1>

<!-- Add Item Card -->
<div class="card bg-white shadow-xl border border-gray-200 mb-10 rounded-xl">
  <div class="card-body">
    <h2 class="text-xl font-semibold text-gray-700 mb-4">Add New Item</h2>

    <form action="{{ url_for('menu.add_item') }}" method="post" 
          class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {% from 'components/forms.html' import text, number, checkbox %}

      <!-- Inputs -->
      {{ text('name','Name','', 'text','', true) }}
      {{ number('price','Price','', '0.01', 0, None, true) }}
      {{ number('stock_qty','Stock Qty','0', '1', 0, None, false) }}

      {{ checkbox('is_available','Available', true) }}

      <!-- Description + Add Button -->
      <div class="sm:col-span-1 lg:col-span-2 flex gap-4">
        <div class="flex-1">
          {{ text('description','Description','') }}
        </div>
        <button type="submit" 
                class="btn bg-gradient-to-r from-indigo-600 to-purple-600 
                       text-white font-medium shadow-md hover:opacity-90 
                       px-8 rounded-lg self-end transition">
          Add Item
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Existing Items Section -->
<div class="card bg-gradient-to-r from-blue-50 via-purple-50 to-pink-50 
            shadow-lg border border-gray-200 rounded-xl">
  <div class="card-body">
    <h2 class="text-xl font-semibold text-gray-800 mb-6">Existing Items</h2>

    <div class="overflow-x-auto rounded-lg border border-gray-200 bg-white/80 backdrop-blur-sm">
      <table class="table w-full">
        <thead class="bg-gradient-to-r from-indigo-100 to-purple-100 text-gray-700 uppercase text-sm">
          <tr>
            <th class="py-3">ID</th>
            <th>Name</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Available</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
          <tr class="hover:bg-indigo-50 transition">
            <td>{{ item.item_id }}</td>
            <td class="font-medium">{{ item.name }}</td>
            <td>â‚¹{{ '%.2f'|format(item.price) }}</td>
            <td>{{ item.stock_qty }}</td>
            <td>
              <span class="px-2 py-1 rounded-full text-xs font-semibold 
                           {% if item.is_available %}
                             bg-green-100 text-green-700
                           {% else %}
                             bg-red-100 text-red-700
                           {% endif %}">
                {{ 'Yes' if item.is_available else 'No' }}
              </span>
            </td>
            <td class="space-y-2">
              <!-- Edit Form -->
              <form action="{{ url_for('menu.edit_item', item_id=item.item_id) }}" 
                    method="post" class="flex flex-wrap gap-2 items-center">
                <input name="name" value="{{ item.name }}" 
                       class="input input-bordered input-sm w-28 rounded-lg" />
                <input name="price" value="{{ item.price }}" 
                       class="input input-bordered input-sm w-24 rounded-lg" />
                <input name="stock_qty" value="{{ item.stock_qty }}" 
                       class="input input-bordered input-sm w-20 rounded-lg" />
                <label class="label cursor-pointer gap-2">
                  <span class="label-text">Avail</span>
                  <input type="checkbox" name="is_available" 
                         class="checkbox checkbox-sm" 
                         {% if item.is_available %}checked{% endif %} />
                </label>
                <button type="submit" 
                        class="btn btn-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                  Save
                </button>
              </form>

              <!-- Delete Form -->
              <form action="{{ url_for('menu.delete_item', item_id=item.item_id) }}" 
                    method="post" class="inline-block">
                <button type="submit" 
                        class="btn btn-sm bg-red-500 text-white rounded-md hover:bg-red-600"
                        onclick="return confirm('Delete item?')">
                  Delete
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

{% endblock %}
